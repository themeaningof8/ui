/**
 * @file TestInfrastructureDesign.md
 * @description テスト基盤の設計書
 * 
 * 概要:
 * - 本設計書は、Bun、TypeScript、React、Tailwind CSS v4、Storybook、Vitest を利用したテスト基盤の全体像と構成、戦略を定義する。
 * - 主な対象は、UIコンポーネント（HoverCard、Tooltip など）およびユーティリティ関数・カスタムフック。
 *
 * 主な仕様:
 * - ユニットテスト、コンポーネント結合テスト、必要に応じた E2E テストの実施
 * - テスト対象コードと Storybook の play 関数によるユーザー視点の動作検証の併用
 * - テストカバレッジしきい値の設定（例：行カバレッジ 80%以上）
 *
 * 制限事項:
 * - Storybook の play 関数は Vitest のカバレッジ計測対象外とする
 * - 一部のテストは Docker コンテナや CI/CD パイプライン上で実行する
 */

# テスト基盤設計書

## 1. はじめに
### 1.1 目的
- 本設計書は、プロジェクトにおけるテスト基盤の全体像、技術構成、実行フロー及びエラーハンドリング手法を定義することを目的とする。
- 品質保証、バグの早期発見、及び継続的な開発サイクルの効率化をサポートするための基盤を提供する。

### 1.2 対象システム
- フロントエンドコンポーネントライブラリ
  - UIコンポーネント（例: HoverCard, Tooltip, AlertDialog, Button, Collapsible など）
  - ユーティリティ関数、カスタムフック
- Storybook により可視化されたコンポーネントのデモとテストシナリオ

## 2. 使用技術スタックおよびツール
- **Bun**: 高速なJavaScriptランタイムおよびパッケージマネージャとして利用
- **TypeScript**: 静的型付けによりコード品質を担保
- **React**: UIコンポーネントの構築
- **Tailwind CSS v4**: デザインの即時反映とスタイルの統一管理
- **Storybook**: コンポーネントのドキュメント化およびインタラクティブなテストシナリオの作成
- **Vitest**: ユニットテスト・コンポーネント結合テストの実施とカバレッジ測定
- **@testing-library/react**: コンポーネントのレンダリングおよびユーザー操作のシミュレーション
- **CI/CD ツール (GitHub Actions 等)**: 自動化テストの実行とレポート生成

## 3. テスト戦略
### 3.1 テストの種類
- **ユニットテスト**:
  - 個々のコンポーネントや関数、フックの正確な動作を検証する
  - Vitest を利用し、迅速なフィードバックループを構築する
- **コンポーネント結合テスト**:
  - 複数のコンポーネント間の連携やインタラクションの検証
  - `@testing-library/react` を活用したDOM 操作、ユーザー操作のシミュレーションによる検証
- **E2E テスト (必要に応じて)**:
  - ユーザーフロー全体を対象とするテスト（例: Playwright や Cypress の導入検討）
  - シナリオベースのテストにより、実際の利用状況に即した挙動の確認

### 3.2 テストカバレッジ指標
- **行カバレッジ (Line Coverage)**: 80%以上
- **分岐カバレッジ (Branch Coverage)**: 75%以上
- **関数カバレッジ (Function Coverage)**: 80%以上
- カバレッジレポートは Vitest により生成し、CI/CD パイプライン上でも確認可能とする

## 4. テスト基盤の構成
### 4.1 ディレクトリ構成例 